{% extends "layout.html" %}

{% block content %}
<script src="static/sortable.min.js"></script>
<link rel="stylesheet" href="static/sortable.min.css">
<style>
    .ui.celled.table {
        border-collapse: collapse;
        margin: 25px 0;
        color: blue;
        font-size: 0.9em;
        min-width: 400px;
    }
    /* Required field in search box prevents capitalisation of placeholder. */
    #userInput:valid { text-transform: uppercase; }
</style>
<form>
<div class="ui left icon input">
    <input name="search" type="text" id="userInput" required="required" placeholder="Search..." onkeyup="filterTable()" data-com.bitwarden.browser.user-edited="yes" value={{ search or '' }}>
    <i class="search icon"></i>
</div>
<div class="ui checkbox">
    <input name="gain" type="checkbox" name="gain" {% if gain %}checked="checked"{% endif %}>
    <label>Gain</label>
</div>
<div class="ui checkbox">
    <input name="pain" type="checkbox" name="pain" {% if pain %}checked="checked"{% endif %}>
    <label>Pain</label>
</div>
<button type="submit" class="ui button primary">
    Filter
  </button>
<button class="ui button">
    Reset
</button>
</form>

<table class="ui celled table sorter" id="cryptoTable">
    <thead>
      <tr>
        <th>Cryptocurrency Pair</th>
        <th>Base Asset</th>
        <th>Quote Asset</th>
        <th>Exchange Rate</th>
        <th>Price Change</th>
        <th>Percentage Change</th>
        <th>Gain</th>
        <th>Pain</th>
      </tr>
    </thead>
    <tbody>
        {% for crypto in cryptos %}
      <tr {% if crypto.gain == 1 %} style="background-color:#fcfff5" {% endif %} {% if crypto.pain == 1 %} style="background-color:#fef5f6" {% endif %}>
        <td>{{crypto.symbol}}</td>
        <td>{{crypto.base_asset}}</td>
        <td>{{crypto.quote_asset}}</td>
        <td>{{crypto.price}}</td>
        <td>{{crypto.change}}</td>
        <td>{{crypto.percentage_change}}</td>
        {% if crypto.gain == 1 %}
        <td style="text-align: center; vertical-align: middle;"><i class="icon checkmark" style="color:green" ></i></td>
        {% else %}
        <td style="text-align: center; vertical-align: middle;"></td>
        {% endif %}
        {% if crypto.pain == 1 %}
        <td style="text-align: center; vertical-align: middle;"><i class="icon close" style="color:crimson" ></i></td>
        {% else %}
        <td style="text-align: center; vertical-align: middle;"></td>
        {% endif %}
      </tr>
      {% endfor %}
    </tbody>
  </table>
  <script>
    function filterTable() {
      // Declare variables
      var input, filter, table, tr, td, i, txtValue;
      input = document.getElementById("userInput");
      filter = input.value.toUpperCase();
      table = document.getElementById("cryptoTable");
      tr = table.getElementsByTagName("tr");
    
      // Loop through all table rows, and hide those who don't match the search query
      for (i = 0; i < tr.length; i++) {
        td = tr[i].getElementsByTagName("td")[0];
        if (td) {
          txtValue = td.textContent || td.innerText;
          if (txtValue.toUpperCase().indexOf(filter) > -1) {
            tr[i].style.display = "";
          } else {
            tr[i].style.display = "none";
          }
        }
      }
    }
    </script>
    
{% endblock %}